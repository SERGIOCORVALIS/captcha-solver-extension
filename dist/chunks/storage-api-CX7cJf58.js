var e=(e=>(e.RECAPTCHA_V2="recaptcha_v2",e.RECAPTCHA_V3="recaptcha_v3",e.HCAPTCHA="hcaptcha",e.TURNSTILE="turnstile",e.IMAGE_CAPTCHA="image_captcha",e.UNKNOWN="unknown",e))(e||{});const t={enabled:!0,autoSolve:!0,hideUI:!1,captchaTypes:{recaptchaV2:!0,recaptchaV3:!0,hcaptcha:!0,turnstile:!0,imageCaptcha:!0},apiConfig:{provider:"custom",apiKey:"JHQBCCKJJBBKJkhKUUKHOWN73987230598TGU",endpoint:"http://localhost:3001/api/solve",timeout:6e5,useLocalSolver:!1},advanced:{clickDelay:500,solveDelay:1e3,retryAttempts:3,enableLogging:!1,mouseMovement:!0,humanLikeBehavior:!0},whitelist:[],blacklist:[],statistics:{totalSolved:0,byType:{[e.RECAPTCHA_V2]:0,[e.RECAPTCHA_V3]:0,[e.HCAPTCHA]:0,[e.TURNSTILE]:0,[e.IMAGE_CAPTCHA]:0,[e.UNKNOWN]:0},lastSolved:null,errors:0}},a="extension_config",r="statistics",i="last_update";function n(){return`${chrome.runtime.id||"default-key"}-captcha-solver-2024`}function o(e){return e?function(e,t){try{const a=atob(e);let r="";for(let e=0;e<a.length;e++)r+=String.fromCharCode(a.charCodeAt(e)^t.charCodeAt(e%t.length));return r}catch{return""}}(e,n()):""}function s(e){try{return atob(e),e.length>0&&/^[A-Za-z0-9+/=]+$/.test(e)}catch{return!1}}class c{static async getConfig(){return new Promise((e,r)=>{try{if("undefined"==typeof chrome||!chrome.runtime||!chrome.runtime.id)return void r(new Error("Extension runtime is not available"));chrome.storage.sync.get(a,i=>{if(chrome.runtime.lastError){const e=chrome.runtime.lastError.message||"Unknown error";return void(e.includes("Extension context invalidated")||e.includes("message port closed")?r(new Error("Extension was reloaded. Please refresh the page.")):r(new Error(e)))}if(i[a]){const r=i[a],n={...t,...r,captchaTypes:{...t.captchaTypes,...r.captchaTypes},apiConfig:{...t.apiConfig,...r.apiConfig,apiKey:"custom"===r.apiConfig?.provider&&r.apiConfig?.apiKey!==t.apiConfig.apiKey?t.apiConfig.apiKey:r.apiConfig?.apiKey||t.apiConfig.apiKey,timeout:Math.max(r.apiConfig?.timeout??t.apiConfig?.timeout??6e5,t.apiConfig?.timeout??6e5)},advanced:{...t.advanced,...r.advanced}};n.apiConfig?.apiKey&&s(n.apiConfig.apiKey)&&(n.apiConfig.apiKey=o(n.apiConfig.apiKey)),e(n)}else e(t)})}catch(i){i instanceof Error&&(i.message.includes("Extension context invalidated")||i.message.includes("message port closed"))?r(new Error("Extension was reloaded. Please refresh the page.")):r(i)}})}static async updateConfig(e){return new Promise((r,o)=>{chrome.storage.sync.get(a,c=>{const p=c[a]||t,h=e.apiConfig?{...e.apiConfig}:p.apiConfig;var l;h?.apiKey&&!s(h.apiKey)&&(h.apiKey=(l=h.apiKey)?function(e,t){let a="";for(let r=0;r<e.length;r++)a+=String.fromCharCode(e.charCodeAt(r)^t.charCodeAt(r%t.length));return btoa(a)}(l,n()):"");const g={...p,...e,captchaTypes:{...p.captchaTypes,...e.captchaTypes},apiConfig:h||p.apiConfig,advanced:{...p.advanced,...e.advanced}};chrome.storage.sync.set({[a]:g,[i]:Date.now()},()=>{chrome.runtime.lastError?o(chrome.runtime.lastError):r()})})})}static async getStatistics(){return new Promise(e=>{chrome.storage.sync.get([a,r],i=>{const n=i[a]||t,o=i[r]||n.statistics;e(o)})})}static async updateStatistics(e){return new Promise((t,a)=>{this.getStatistics().then(i=>{const n=e(i);chrome.storage.sync.set({[r]:n},()=>{chrome.runtime.lastError?a(chrome.runtime.lastError):t()})})})}static async resetStatistics(){return new Promise((e,i)=>{chrome.storage.sync.get(a,n=>{const o=n[a]||t;chrome.storage.sync.set({[r]:o.statistics},()=>{chrome.runtime.lastError?i(chrome.runtime.lastError):e()})})})}}export{e as C,c as S,o as d,s as i};
